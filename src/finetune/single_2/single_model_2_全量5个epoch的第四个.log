2022-08-04 09:10:40 - INFO - Training/evaluation parameters: Namespace(accumlate_step=1, adam_epsilon=1e-06, batch_size=32, bert_cache='data/cache', bert_dir='/home/tione/notebook/env/baseline/opensource_models/chinese-macbert-base', bert_hidden_dropout_prob=0.1, bert_learning_rate=3e-05, bert_max_steps=30000, bert_seq_length=245, bert_seq_length_infer=145, bert_warmup_steps=5000, best_score=0.5, ckpt_file='./save/v1/model_.bin', classifier_learning_rate=4e-05, clip_vit_dir='./inference_model/ViT-B-16.pt', dropout=0.25, fc_size=512, fgm=True, fold=2, frame_embedding_size=768, freeze=False, freeze_bert_layer=6, learning_rate=7e-05, local_rank=0, log_name='macbert', max_epochs=5, max_frames=16, max_frames_infer=1, max_steps=14000, minimum_lr=0.0, nprocs=2, num_top_layer=4, num_workers=8, prefetch=16, print_steps=100, savedmodel_path='./save', se_ratio=8, seed=2012, test_annotation='/opt/ml/input/data/annotations/test.json', test_batch_size=125, test_output_csv='data/base_result.csv', test_zip_feats='/opt/ml/input/data/zip_frames/test/', text_transforemr_layers=12, train_annotation='/home/tione/notebook/data/annotations/labeled.json', train_zip_feats='/home/tione/notebook/data/Vit_B_16_unlabeled_zip_feats', val_batch_size=50, val_ratio=0.1, video_fc_lr=5e-05, vision_model='swin_tiny', vison_learning_rate=0.0001, vlad_cluster_size=64, vlad_groups=8, vlad_hidden_size=1024, warmup_steps=1000, weight_decay=0.01)
2022-08-04 09:11:38 - INFO - Epoch 0 step 100 lr 2.9876227059325647e-06: total loss 5.300,accuracy1 0.009
2022-08-04 09:12:23 - INFO - Epoch 0 step 200 lr 5.9752454118651295e-06: total loss 5.070,accuracy1 0.050
2022-08-04 09:13:09 - INFO - Epoch 0 step 300 lr 8.962868117797695e-06: total loss 4.770,accuracy1 0.096
2022-08-04 09:13:54 - INFO - Epoch 0 step 400 lr 1.1950490823730259e-05: total loss 4.436,accuracy1 0.156
2022-08-04 09:14:39 - INFO - Epoch 0 step 500 lr 1.4938113529662825e-05: total loss 4.114,accuracy1 0.215
2022-08-04 09:15:25 - INFO - Epoch 0 step 600 lr 1.792573623559539e-05: total loss 3.840,accuracy1 0.263
2022-08-04 09:16:10 - INFO - Epoch 0 step 700 lr 2.0913358941527954e-05: total loss 3.633,accuracy1 0.297
2022-08-04 09:16:56 - INFO - Epoch 0 step 800 lr 2.3900981647460518e-05: total loss 3.447,accuracy1 0.327
2022-08-04 09:17:41 - INFO - Epoch 0 step 900 lr 2.6888604353393085e-05: total loss 3.286,accuracy1 0.351
2022-08-04 09:18:26 - INFO - Epoch 0 step 1000 lr 2.987622705932565e-05: total loss 3.159,accuracy1 0.369
2022-08-04 09:19:11 - INFO - Epoch 0 step 1100 lr 3.2863849765258214e-05: total loss 3.041,accuracy1 0.387
2022-08-04 09:19:57 - INFO - Epoch 0 step 1200 lr 3.585147247119078e-05: total loss 2.940,accuracy1 0.404
2022-08-04 09:20:42 - INFO - Epoch 0 step 1300 lr 3.883909517712334e-05: total loss 2.855,accuracy1 0.417
2022-08-04 09:21:28 - INFO - Epoch 0 step 1400 lr 4.182671788305591e-05: total loss 2.774,accuracy1 0.428
2022-08-04 09:22:13 - INFO - Epoch 0 step 1500 lr 4.481434058898847e-05: total loss 2.702,accuracy1 0.439
2022-08-04 09:23:00 - INFO - Epoch 0 step 1600 lr 4.7801963294921036e-05: total loss 2.635,accuracy1 0.449
2022-08-04 09:23:45 - INFO - Epoch 0 step 1700 lr 5.07895860008536e-05: total loss 2.576,accuracy1 0.458
2022-08-04 09:24:31 - INFO - Epoch 0 step 1800 lr 5.377720870678617e-05: total loss 2.528,accuracy1 0.464
2022-08-04 09:25:18 - INFO - Epoch 0 step 1900 lr 5.6764831412718735e-05: total loss 2.476,accuracy1 0.472
2022-08-04 09:26:06 - INFO - Epoch 0 step 2000 lr 5.97524541186513e-05: total loss 2.430,accuracy1 0.479
2022-08-04 09:26:56 - INFO - Epoch 0 step 2100 lr 6.274007682458386e-05: total loss 2.387,accuracy1 0.486
2022-08-04 09:27:48 - INFO - Epoch 0 step 2200 lr 6.572769953051643e-05: total loss 2.349,accuracy1 0.491
2022-08-04 09:28:40 - INFO - Epoch 0 step 2300 lr 6.871532223644899e-05: total loss 2.314,accuracy1 0.496
2022-08-04 09:29:33 - INFO - Epoch 0 step 2400 lr 6.999681907100301e-05: total loss 2.281,accuracy1 0.500
2022-08-04 09:30:27 - INFO - Epoch 0 step 2500 lr 6.997586983798076e-05: total loss 2.250,accuracy1 0.505
2022-08-04 09:31:22 - INFO - Epoch 0 step 2600 lr 6.993535374801442e-05: total loss 2.221,accuracy1 0.509
2022-08-04 09:32:21 - INFO - Epoch 0 step 2700 lr 6.987529346737474e-05: total loss 2.193,accuracy1 0.513
2022-08-04 09:33:20 - INFO - Epoch 0 step 2800 lr 6.979572259611012e-05: total loss 2.166,accuracy1 0.517
2022-08-04 09:34:20 - INFO - Epoch 0 step 2900 lr 6.969668564924944e-05: total loss 2.138,accuracy1 0.521
2022-08-04 09:35:21 - INFO - Epoch 0 step 3000 lr 6.957823803189856e-05: total loss 2.112,accuracy1 0.525
2022-08-04 09:36:22 - INFO - Epoch 0 step 3100 lr 6.944044600824459e-05: total loss 2.089,accuracy1 0.529
2022-08-04 09:37:23 - INFO - Epoch 1 step 100 lr 6.924112137030455e-05: total loss 1.264,accuracy1 0.659
2022-08-04 09:38:09 - INFO - Epoch 1 step 200 lr 6.906010269524272e-05: total loss 1.239,accuracy1 0.664
2022-08-04 09:38:54 - INFO - Epoch 1 step 300 lr 6.886002947886351e-05: total loss 1.216,accuracy1 0.676
2022-08-04 09:39:40 - INFO - Epoch 1 step 400 lr 6.864101364987723e-05: total loss 1.220,accuracy1 0.670
2022-08-04 09:40:25 - INFO - Epoch 1 step 500 lr 6.840317773422576e-05: total loss 1.218,accuracy1 0.669
2022-08-04 09:41:11 - INFO - Epoch 1 step 600 lr 6.814665478653671e-05: total loss 1.225,accuracy1 0.668
2022-08-04 09:41:56 - INFO - Epoch 1 step 700 lr 6.787158831568762e-05: total loss 1.209,accuracy1 0.671
2022-08-04 09:42:41 - INFO - Epoch 1 step 800 lr 6.757813220452141e-05: total loss 1.208,accuracy1 0.670
2022-08-04 09:43:27 - INFO - Epoch 1 step 900 lr 6.726645062375846e-05: total loss 1.212,accuracy1 0.669
2022-08-04 09:44:12 - INFO - Epoch 1 step 1000 lr 6.693671794015307e-05: total loss 1.214,accuracy1 0.668
2022-08-04 09:44:58 - INFO - Epoch 1 step 1100 lr 6.658911861894599e-05: total loss 1.210,accuracy1 0.669
2022-08-04 09:45:43 - INFO - Epoch 1 step 1200 lr 6.622384712066739e-05: total loss 1.207,accuracy1 0.670
2022-08-04 09:46:28 - INFO - Epoch 1 step 1300 lr 6.584110779234812e-05: total loss 1.206,accuracy1 0.670
2022-08-04 09:47:14 - INFO - Epoch 1 step 1400 lr 6.544111475320004e-05: total loss 1.203,accuracy1 0.671
2022-08-04 09:47:59 - INFO - Epoch 1 step 1500 lr 6.502409177482947e-05: total loss 1.204,accuracy1 0.670
2022-08-04 09:48:44 - INFO - Epoch 1 step 1600 lr 6.459027215605063e-05: total loss 1.197,accuracy1 0.672
2022-08-04 09:49:30 - INFO - Epoch 1 step 1700 lr 6.41398985923693e-05: total loss 1.197,accuracy1 0.671
2022-08-04 09:50:18 - INFO - Epoch 1 step 1800 lr 6.367322304020954e-05: total loss 1.196,accuracy1 0.672
2022-08-04 09:51:04 - INFO - Epoch 1 step 1900 lr 6.319050657595943e-05: total loss 1.193,accuracy1 0.672
2022-08-04 09:51:54 - INFO - Epoch 1 step 2000 lr 6.269201924991492e-05: total loss 1.194,accuracy1 0.671
2022-08-04 09:52:44 - INFO - Epoch 1 step 2100 lr 6.21780399352032e-05: total loss 1.194,accuracy1 0.672
2022-08-04 09:53:36 - INFO - Epoch 1 step 2200 lr 6.164885617177019e-05: total loss 1.188,accuracy1 0.673
2022-08-04 09:54:28 - INFO - Epoch 1 step 2300 lr 6.11047640055197e-05: total loss 1.187,accuracy1 0.673
2022-08-04 09:55:22 - INFO - Epoch 1 step 2400 lr 6.054606782269374e-05: total loss 1.181,accuracy1 0.675
2022-08-04 09:56:19 - INFO - Epoch 1 step 2500 lr 5.997308017958711e-05: total loss 1.180,accuracy1 0.675
2022-08-04 09:57:15 - INFO - Epoch 1 step 2600 lr 5.938612162769134e-05: total loss 1.178,accuracy1 0.675
2022-08-04 09:58:12 - INFO - Epoch 1 step 2700 lr 5.87855205343657e-05: total loss 1.174,accuracy1 0.676
2022-08-04 09:59:13 - INFO - Epoch 1 step 2800 lr 5.817161289913579e-05: total loss 1.173,accuracy1 0.676
2022-08-04 10:00:12 - INFO - Epoch 1 step 2900 lr 5.754474216572243e-05: total loss 1.170,accuracy1 0.677
2022-08-04 10:01:12 - INFO - Epoch 1 step 3000 lr 5.6905259029905874e-05: total loss 1.169,accuracy1 0.677
2022-08-04 10:02:15 - INFO - Epoch 1 step 3100 lr 5.625352124333304e-05: total loss 1.169,accuracy1 0.678
2022-08-04 10:03:20 - INFO - Epoch 2 step 100 lr 5.542217200033303e-05: total loss 0.948,accuracy1 0.733
2022-08-04 10:04:05 - INFO - Epoch 2 step 200 lr 5.474420445907076e-05: total loss 0.914,accuracy1 0.733
2022-08-04 10:04:50 - INFO - Epoch 2 step 300 lr 5.4055191244722576e-05: total loss 0.890,accuracy1 0.746
2022-08-04 10:05:36 - INFO - Epoch 2 step 400 lr 5.3355517817980673e-05: total loss 0.883,accuracy1 0.747
2022-08-04 10:06:21 - INFO - Epoch 2 step 500 lr 5.264557560327316e-05: total loss 0.875,accuracy1 0.749
2022-08-04 10:07:07 - INFO - Epoch 2 step 600 lr 5.192576176978604e-05: total loss 0.874,accuracy1 0.749
2022-08-04 10:07:52 - INFO - Epoch 2 step 700 lr 5.119647900927141e-05: total loss 0.859,accuracy1 0.752
2022-08-04 10:08:37 - INFO - Epoch 2 step 800 lr 5.045813531076609e-05: total loss 0.858,accuracy1 0.752
2022-08-04 10:09:23 - INFO - Epoch 2 step 900 lr 4.9711143732346716e-05: total loss 0.863,accuracy1 0.752
2022-08-04 10:10:08 - INFO - Epoch 2 step 1000 lr 4.895592217004908e-05: total loss 0.860,accuracy1 0.753
2022-08-04 10:10:53 - INFO - Epoch 2 step 1100 lr 4.819289312408086e-05: total loss 0.853,accuracy1 0.755
2022-08-04 10:11:39 - INFO - Epoch 2 step 1200 lr 4.742248346245865e-05: total loss 0.850,accuracy1 0.756
2022-08-04 10:12:24 - INFO - Epoch 2 step 1300 lr 4.664512418220148e-05: total loss 0.847,accuracy1 0.756
2022-08-04 10:13:10 - INFO - Epoch 2 step 1400 lr 4.5861250168214324e-05: total loss 0.846,accuracy1 0.756
2022-08-04 10:13:55 - INFO - Epoch 2 step 1500 lr 4.507129994999663e-05: total loss 0.844,accuracy1 0.757
2022-08-04 10:14:40 - INFO - Epoch 2 step 1600 lr 4.427571545631201e-05: total loss 0.838,accuracy1 0.759
2022-08-04 10:15:26 - INFO - Epoch 2 step 1700 lr 4.3474941767956084e-05: total loss 0.835,accuracy1 0.760
2022-08-04 10:16:12 - INFO - Epoch 2 step 1800 lr 4.266942686876105e-05: total loss 0.831,accuracy1 0.761
2022-08-04 10:17:01 - INFO - Epoch 2 step 1900 lr 4.185962139497617e-05: total loss 0.828,accuracy1 0.762
2022-08-04 10:17:49 - INFO - Epoch 2 step 2000 lr 4.104597838316441e-05: total loss 0.829,accuracy1 0.761
2022-08-04 10:18:40 - INFO - Epoch 2 step 2100 lr 4.022895301675624e-05: total loss 0.827,accuracy1 0.762
2022-08-04 10:19:33 - INFO - Epoch 2 step 2200 lr 3.940900237140232e-05: total loss 0.821,accuracy1 0.764
2022-08-04 10:20:25 - INFO - Epoch 2 step 2300 lr 3.858658515926772e-05: total loss 0.818,accuracy1 0.766
2022-08-04 10:21:19 - INFO - Epoch 2 step 2400 lr 3.776216147241057e-05: total loss 0.813,accuracy1 0.767
2022-08-04 10:22:13 - INFO - Epoch 2 step 2500 lr 3.6936192525388684e-05: total loss 0.811,accuracy1 0.768
2022-08-04 10:23:09 - INFO - Epoch 2 step 2600 lr 3.6109140397238346e-05: total loss 0.808,accuracy1 0.768
2022-08-04 10:24:07 - INFO - Epoch 2 step 2700 lr 3.528146777296927e-05: total loss 0.806,accuracy1 0.769
2022-08-04 10:25:07 - INFO - Epoch 2 step 2800 lr 3.445363768472077e-05: total loss 0.804,accuracy1 0.769
2022-08-04 10:26:07 - INFO - Epoch 2 step 2900 lr 3.362611325272364e-05: total loss 0.804,accuracy1 0.770
2022-08-04 10:27:07 - INFO - Epoch 2 step 3000 lr 3.279935742621269e-05: total loss 0.803,accuracy1 0.770
2022-08-04 10:28:10 - INFO - Epoch 2 step 3100 lr 3.197383272443505e-05: total loss 0.803,accuracy1 0.770
2022-08-04 10:29:15 - INFO - Epoch 3 step 100 lr 3.09443615997907e-05: total loss 0.629,accuracy1 0.823
2022-08-04 10:30:01 - INFO - Epoch 3 step 200 lr 3.0123294029044994e-05: total loss 0.615,accuracy1 0.818
2022-08-04 10:30:46 - INFO - Epoch 3 step 300 lr 2.930495467659762e-05: total loss 0.591,accuracy1 0.831
2022-08-04 10:31:32 - INFO - Epoch 3 step 400 lr 2.8489801353193958e-05: total loss 0.586,accuracy1 0.829
2022-08-04 10:32:17 - INFO - Epoch 3 step 500 lr 2.76782900871913e-05: total loss 0.577,accuracy1 0.832
2022-08-04 10:33:03 - INFO - Epoch 3 step 600 lr 2.6870874869438876e-05: total loss 0.574,accuracy1 0.835
2022-08-04 10:33:49 - INFO - Epoch 3 step 700 lr 2.606800739929779e-05: total loss 0.562,accuracy1 0.839
2022-08-04 10:34:34 - INFO - Epoch 3 step 800 lr 2.5270136831942915e-05: total loss 0.560,accuracy1 0.838
2022-08-04 10:35:20 - INFO - Epoch 3 step 900 lr 2.447770952708807e-05: total loss 0.563,accuracy1 0.836
2022-08-04 10:36:05 - INFO - Epoch 3 step 1000 lr 2.3691168799275106e-05: total loss 0.560,accuracy1 0.838
2022-08-04 10:36:51 - INFO - Epoch 3 step 1100 lr 2.2910954669866546e-05: total loss 0.555,accuracy1 0.840
2022-08-04 10:37:36 - INFO - Epoch 3 step 1200 lr 2.2137503620880613e-05: total loss 0.551,accuracy1 0.841
2022-08-04 10:38:22 - INFO - Epoch 3 step 1300 lr 2.1371248350806245e-05: total loss 0.550,accuracy1 0.841
2022-08-04 10:39:08 - INFO - Epoch 3 step 1400 lr 2.061261753253485e-05: total loss 0.550,accuracy1 0.841
2022-08-04 10:39:53 - INFO - Epoch 3 step 1500 lr 1.986203557354401e-05: total loss 0.549,accuracy1 0.842
2022-08-04 10:40:39 - INFO - Epoch 3 step 1600 lr 1.9119922378467528e-05: total loss 0.545,accuracy1 0.844
2022-08-04 10:41:26 - INFO - Epoch 3 step 1700 lr 1.8386693114184512e-05: total loss 0.543,accuracy1 0.844
2022-08-04 10:42:13 - INFO - Epoch 3 step 1800 lr 1.7662757977558917e-05: total loss 0.541,accuracy1 0.845
2022-08-04 10:43:00 - INFO - Epoch 3 step 1900 lr 1.6948521965959503e-05: total loss 0.539,accuracy1 0.845
2022-08-04 10:43:49 - INFO - Epoch 3 step 2000 lr 1.6244384650688666e-05: total loss 0.539,accuracy1 0.845
2022-08-04 10:44:41 - INFO - Epoch 3 step 2100 lr 1.5550739953446747e-05: total loss 0.539,accuracy1 0.845
2022-08-04 10:45:33 - INFO - Epoch 3 step 2200 lr 1.4867975925956915e-05: total loss 0.536,accuracy1 0.846
2022-08-04 10:46:25 - INFO - Epoch 3 step 2300 lr 1.4196474532874081e-05: total loss 0.533,accuracy1 0.847
2022-08-04 10:47:19 - INFO - Epoch 3 step 2400 lr 1.3536611438099034e-05: total loss 0.530,accuracy1 0.847
2022-08-04 10:48:13 - INFO - Epoch 3 step 2500 lr 1.2888755794617435e-05: total loss 0.530,accuracy1 0.848
2022-08-04 10:49:09 - INFO - Epoch 3 step 2600 lr 1.2253270037981475e-05: total loss 0.529,accuracy1 0.848
2022-08-04 10:50:09 - INFO - Epoch 3 step 2700 lr 1.1630509683549217e-05: total loss 0.527,accuracy1 0.848
2022-08-04 10:51:06 - INFO - Epoch 3 step 2800 lr 1.102082312759564e-05: total loss 0.526,accuracy1 0.848
2022-08-04 10:52:05 - INFO - Epoch 3 step 2900 lr 1.042455145240625e-05: total loss 0.527,accuracy1 0.848
2022-08-04 10:53:07 - INFO - Epoch 3 step 3000 lr 9.842028235462357e-06: total loss 0.527,accuracy1 0.848
2022-08-04 10:54:10 - INFO - Epoch 3 step 3100 lr 9.273579362825002e-06: total loss 0.527,accuracy1 0.848
