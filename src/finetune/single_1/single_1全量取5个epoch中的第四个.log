2022-08-04 01:22:22 - INFO - Training/evaluation parameters: Namespace(accumlate_step=1, adam_epsilon=1e-06, batch_size=32, bert_cache='data/cache', bert_dir='/home/tione/notebook/env/baseline/opensource_models/chinese-macbert-base', bert_hidden_dropout_prob=0.1, bert_learning_rate=3e-05, bert_max_steps=30000, bert_seq_length=245, bert_seq_length_infer=145, bert_warmup_steps=5000, best_score=0.5, ckpt_file='./save/v1/model_.bin', classifier_learning_rate=4e-05, clip_vit_dir='./inference_model/ViT-B-16.pt', dropout=0.25, fc_size=512, fgm=True, fold=2, frame_embedding_size=768, freeze=True, freeze_bert_layer=6, learning_rate=7e-05, local_rank=0, log_name='macbert', max_epochs=5, max_frames=16, max_frames_infer=1, max_steps=14000, minimum_lr=0.0, nprocs=2, num_top_layer=4, num_workers=8, prefetch=16, print_steps=100, savedmodel_path='./save', se_ratio=8, seed=2012, test_annotation='/opt/ml/input/data/annotations/test.json', test_batch_size=125, test_output_csv='data/base_result.csv', test_zip_feats='/opt/ml/input/data/zip_frames/test/', text_transforemr_layers=12, train_annotation='/home/tione/notebook/data/annotations/labeled.json', train_zip_feats='/home/tione/notebook/data/Vit_B_16_unlabeled_zip_feats', val_batch_size=50, val_ratio=0.1, video_fc_lr=5e-05, vision_model='swin_tiny', vison_learning_rate=0.0001, vlad_cluster_size=64, vlad_groups=8, vlad_hidden_size=1024, warmup_steps=1000, weight_decay=0.01)
2022-08-04 01:23:21 - INFO - Epoch 0 step 100 lr 2.9876227059325647e-06: total loss 5.222,accuracy1 0.037
2022-08-04 01:24:07 - INFO - Epoch 0 step 200 lr 5.9752454118651295e-06: total loss 4.969,accuracy1 0.079
2022-08-04 01:24:54 - INFO - Epoch 0 step 300 lr 8.962868117797695e-06: total loss 4.659,accuracy1 0.127
2022-08-04 01:25:40 - INFO - Epoch 0 step 400 lr 1.1950490823730259e-05: total loss 4.297,accuracy1 0.190
2022-08-04 01:26:26 - INFO - Epoch 0 step 500 lr 1.4938113529662825e-05: total loss 3.966,accuracy1 0.246
2022-08-04 01:27:12 - INFO - Epoch 0 step 600 lr 1.792573623559539e-05: total loss 3.691,accuracy1 0.289
2022-08-04 01:27:58 - INFO - Epoch 0 step 700 lr 2.0913358941527954e-05: total loss 3.485,accuracy1 0.321
2022-08-04 01:28:44 - INFO - Epoch 0 step 800 lr 2.3900981647460518e-05: total loss 3.301,accuracy1 0.349
2022-08-04 01:29:30 - INFO - Epoch 0 step 900 lr 2.6888604353393085e-05: total loss 3.140,accuracy1 0.373
2022-08-04 01:30:17 - INFO - Epoch 0 step 1000 lr 2.987622705932565e-05: total loss 3.018,accuracy1 0.390
2022-08-04 01:31:03 - INFO - Epoch 0 step 1100 lr 3.2863849765258214e-05: total loss 2.906,accuracy1 0.407
2022-08-04 01:31:49 - INFO - Epoch 0 step 1200 lr 3.585147247119078e-05: total loss 2.809,accuracy1 0.421
2022-08-04 01:32:35 - INFO - Epoch 0 step 1300 lr 3.883909517712334e-05: total loss 2.728,accuracy1 0.432
2022-08-04 01:33:22 - INFO - Epoch 0 step 1400 lr 4.182671788305591e-05: total loss 2.650,accuracy1 0.444
2022-08-04 01:34:08 - INFO - Epoch 0 step 1500 lr 4.481434058898847e-05: total loss 2.582,accuracy1 0.454
2022-08-04 01:34:59 - INFO - Epoch 0 step 1600 lr 4.7801963294921036e-05: total loss 2.518,accuracy1 0.463
2022-08-04 01:35:49 - INFO - Epoch 0 step 1700 lr 5.07895860008536e-05: total loss 2.462,accuracy1 0.471
2022-08-04 01:36:40 - INFO - Epoch 0 step 1800 lr 5.377720870678617e-05: total loss 2.416,accuracy1 0.477
2022-08-04 01:37:33 - INFO - Epoch 0 step 1900 lr 5.6764831412718735e-05: total loss 2.368,accuracy1 0.483
2022-08-04 01:38:29 - INFO - Epoch 0 step 2000 lr 5.97524541186513e-05: total loss 2.327,accuracy1 0.490
2022-08-04 01:39:25 - INFO - Epoch 0 step 2100 lr 6.274007682458386e-05: total loss 2.287,accuracy1 0.496
2022-08-04 01:40:21 - INFO - Epoch 0 step 2200 lr 6.572769953051643e-05: total loss 2.252,accuracy1 0.500
2022-08-04 01:41:21 - INFO - Epoch 0 step 2300 lr 6.871532223644899e-05: total loss 2.220,accuracy1 0.504
2022-08-04 01:42:20 - INFO - Epoch 0 step 2400 lr 6.999681907100301e-05: total loss 2.189,accuracy1 0.509
2022-08-04 01:43:21 - INFO - Epoch 0 step 2500 lr 6.997586983798076e-05: total loss 2.160,accuracy1 0.513
2022-08-04 01:44:25 - INFO - Epoch 0 step 2600 lr 6.993535374801442e-05: total loss 2.132,accuracy1 0.517
2022-08-04 01:45:30 - INFO - Epoch 0 step 2700 lr 6.987529346737474e-05: total loss 2.106,accuracy1 0.521
2022-08-04 01:46:34 - INFO - Epoch 0 step 2800 lr 6.979572259611012e-05: total loss 2.081,accuracy1 0.525
2022-08-04 01:47:42 - INFO - Epoch 0 step 2900 lr 6.969668564924944e-05: total loss 2.055,accuracy1 0.529
2022-08-04 01:48:50 - INFO - Epoch 0 step 3000 lr 6.957823803189856e-05: total loss 2.030,accuracy1 0.532
2022-08-04 01:50:00 - INFO - Epoch 0 step 3100 lr 6.944044600824459e-05: total loss 2.009,accuracy1 0.536
2022-08-04 01:51:05 - INFO - Epoch 1 step 100 lr 6.924112137030455e-05: total loss 1.214,accuracy1 0.665
2022-08-04 01:51:51 - INFO - Epoch 1 step 200 lr 6.906010269524272e-05: total loss 1.193,accuracy1 0.671
2022-08-04 01:52:37 - INFO - Epoch 1 step 300 lr 6.886002947886351e-05: total loss 1.177,accuracy1 0.674
2022-08-04 01:53:23 - INFO - Epoch 1 step 400 lr 6.864101364987723e-05: total loss 1.180,accuracy1 0.670
2022-08-04 01:54:09 - INFO - Epoch 1 step 500 lr 6.840317773422576e-05: total loss 1.179,accuracy1 0.671
2022-08-04 01:54:55 - INFO - Epoch 1 step 600 lr 6.814665478653671e-05: total loss 1.181,accuracy1 0.673
2022-08-04 01:55:42 - INFO - Epoch 1 step 700 lr 6.787158831568762e-05: total loss 1.168,accuracy1 0.675
2022-08-04 01:56:28 - INFO - Epoch 1 step 800 lr 6.757813220452141e-05: total loss 1.168,accuracy1 0.675
2022-08-04 01:57:14 - INFO - Epoch 1 step 900 lr 6.726645062375846e-05: total loss 1.171,accuracy1 0.674
2022-08-04 01:58:00 - INFO - Epoch 1 step 1000 lr 6.693671794015307e-05: total loss 1.173,accuracy1 0.674
2022-08-04 01:58:46 - INFO - Epoch 1 step 1100 lr 6.658911861894599e-05: total loss 1.172,accuracy1 0.674
2022-08-04 01:59:33 - INFO - Epoch 1 step 1200 lr 6.622384712066739e-05: total loss 1.169,accuracy1 0.675
2022-08-04 02:00:19 - INFO - Epoch 1 step 1300 lr 6.584110779234812e-05: total loss 1.169,accuracy1 0.675
2022-08-04 02:01:05 - INFO - Epoch 1 step 1400 lr 6.544111475320004e-05: total loss 1.167,accuracy1 0.676
2022-08-04 02:01:53 - INFO - Epoch 1 step 1500 lr 6.502409177482947e-05: total loss 1.171,accuracy1 0.675
2022-08-04 02:02:43 - INFO - Epoch 1 step 1600 lr 6.459027215605063e-05: total loss 1.164,accuracy1 0.676
2022-08-04 02:03:33 - INFO - Epoch 1 step 1700 lr 6.41398985923693e-05: total loss 1.164,accuracy1 0.676
2022-08-04 02:04:25 - INFO - Epoch 1 step 1800 lr 6.367322304020954e-05: total loss 1.166,accuracy1 0.675
2022-08-04 02:05:19 - INFO - Epoch 1 step 1900 lr 6.319050657595943e-05: total loss 1.165,accuracy1 0.676
2022-08-04 02:06:13 - INFO - Epoch 1 step 2000 lr 6.269201924991492e-05: total loss 1.167,accuracy1 0.675
2022-08-04 02:07:08 - INFO - Epoch 1 step 2100 lr 6.21780399352032e-05: total loss 1.166,accuracy1 0.675
2022-08-04 02:08:07 - INFO - Epoch 1 step 2200 lr 6.164885617177019e-05: total loss 1.161,accuracy1 0.676
2022-08-04 02:09:04 - INFO - Epoch 1 step 2300 lr 6.11047640055197e-05: total loss 1.160,accuracy1 0.676
2022-08-04 02:10:04 - INFO - Epoch 1 step 2400 lr 6.054606782269374e-05: total loss 1.155,accuracy1 0.678
2022-08-04 02:11:07 - INFO - Epoch 1 step 2500 lr 5.997308017958711e-05: total loss 1.153,accuracy1 0.678
2022-08-04 02:12:10 - INFO - Epoch 1 step 2600 lr 5.938612162769134e-05: total loss 1.151,accuracy1 0.679
2022-08-04 02:13:13 - INFO - Epoch 1 step 2700 lr 5.87855205343657e-05: total loss 1.147,accuracy1 0.679
2022-08-04 02:14:19 - INFO - Epoch 1 step 2800 lr 5.817161289913579e-05: total loss 1.145,accuracy1 0.679
2022-08-04 02:15:26 - INFO - Epoch 1 step 2900 lr 5.754474216572243e-05: total loss 1.142,accuracy1 0.680
2022-08-04 02:16:34 - INFO - Epoch 1 step 3000 lr 5.6905259029905874e-05: total loss 1.142,accuracy1 0.680
2022-08-04 02:17:44 - INFO - Epoch 1 step 3100 lr 5.625352124333304e-05: total loss 1.141,accuracy1 0.680
2022-08-04 02:18:50 - INFO - Epoch 2 step 100 lr 5.542217200033303e-05: total loss 0.915,accuracy1 0.740
2022-08-04 02:19:36 - INFO - Epoch 2 step 200 lr 5.474420445907076e-05: total loss 0.882,accuracy1 0.746
2022-08-04 02:20:22 - INFO - Epoch 2 step 300 lr 5.4055191244722576e-05: total loss 0.846,accuracy1 0.758
2022-08-04 02:21:08 - INFO - Epoch 2 step 400 lr 5.3355517817980673e-05: total loss 0.839,accuracy1 0.758
2022-08-04 02:21:54 - INFO - Epoch 2 step 500 lr 5.264557560327316e-05: total loss 0.831,accuracy1 0.758
2022-08-04 02:22:40 - INFO - Epoch 2 step 600 lr 5.192576176978604e-05: total loss 0.829,accuracy1 0.760
2022-08-04 02:23:27 - INFO - Epoch 2 step 700 lr 5.119647900927141e-05: total loss 0.810,accuracy1 0.765
2022-08-04 02:24:13 - INFO - Epoch 2 step 800 lr 5.045813531076609e-05: total loss 0.809,accuracy1 0.765
2022-08-04 02:24:59 - INFO - Epoch 2 step 900 lr 4.9711143732346716e-05: total loss 0.811,accuracy1 0.764
2022-08-04 02:25:45 - INFO - Epoch 2 step 1000 lr 4.895592217004908e-05: total loss 0.808,accuracy1 0.765
2022-08-04 02:26:32 - INFO - Epoch 2 step 1100 lr 4.819289312408086e-05: total loss 0.803,accuracy1 0.766
2022-08-04 02:27:18 - INFO - Epoch 2 step 1200 lr 4.742248346245865e-05: total loss 0.799,accuracy1 0.767
2022-08-04 02:28:05 - INFO - Epoch 2 step 1300 lr 4.664512418220148e-05: total loss 0.798,accuracy1 0.767
2022-08-04 02:28:51 - INFO - Epoch 2 step 1400 lr 4.5861250168214324e-05: total loss 0.796,accuracy1 0.767
2022-08-04 02:29:39 - INFO - Epoch 2 step 1500 lr 4.507129994999663e-05: total loss 0.797,accuracy1 0.768
2022-08-04 02:30:27 - INFO - Epoch 2 step 1600 lr 4.427571545631201e-05: total loss 0.790,accuracy1 0.769
2022-08-04 02:31:18 - INFO - Epoch 2 step 1700 lr 4.3474941767956084e-05: total loss 0.787,accuracy1 0.770
2022-08-04 02:32:11 - INFO - Epoch 2 step 1800 lr 4.266942686876105e-05: total loss 0.785,accuracy1 0.770
2022-08-04 02:33:04 - INFO - Epoch 2 step 1900 lr 4.185962139497617e-05: total loss 0.783,accuracy1 0.771
2022-08-04 02:33:58 - INFO - Epoch 2 step 2000 lr 4.104597838316441e-05: total loss 0.785,accuracy1 0.770
2022-08-04 02:34:53 - INFO - Epoch 2 step 2100 lr 4.022895301675624e-05: total loss 0.784,accuracy1 0.771
2022-08-04 02:35:51 - INFO - Epoch 2 step 2200 lr 3.940900237140232e-05: total loss 0.779,accuracy1 0.772
2022-08-04 02:36:50 - INFO - Epoch 2 step 2300 lr 3.858658515926772e-05: total loss 0.777,accuracy1 0.772
2022-08-04 02:37:50 - INFO - Epoch 2 step 2400 lr 3.776216147241057e-05: total loss 0.773,accuracy1 0.773
2022-08-04 02:38:51 - INFO - Epoch 2 step 2500 lr 3.6936192525388684e-05: total loss 0.771,accuracy1 0.774
2022-08-04 02:39:55 - INFO - Epoch 2 step 2600 lr 3.6109140397238346e-05: total loss 0.769,accuracy1 0.775
2022-08-04 02:41:01 - INFO - Epoch 2 step 2700 lr 3.528146777296927e-05: total loss 0.766,accuracy1 0.776
2022-08-04 02:42:05 - INFO - Epoch 2 step 2800 lr 3.445363768472077e-05: total loss 0.764,accuracy1 0.776
2022-08-04 02:43:11 - INFO - Epoch 2 step 2900 lr 3.362611325272364e-05: total loss 0.763,accuracy1 0.777
2022-08-04 02:44:20 - INFO - Epoch 2 step 3000 lr 3.279935742621269e-05: total loss 0.762,accuracy1 0.777
2022-08-04 02:45:29 - INFO - Epoch 2 step 3100 lr 3.197383272443505e-05: total loss 0.761,accuracy1 0.778
2022-08-04 02:46:41 - INFO - Epoch 3 step 100 lr 3.09443615997907e-05: total loss 0.579,accuracy1 0.844
2022-08-04 02:47:27 - INFO - Epoch 3 step 200 lr 3.0123294029044994e-05: total loss 0.570,accuracy1 0.839
2022-08-04 02:48:13 - INFO - Epoch 3 step 300 lr 2.930495467659762e-05: total loss 0.536,accuracy1 0.847
2022-08-04 02:49:00 - INFO - Epoch 3 step 400 lr 2.8489801353193958e-05: total loss 0.528,accuracy1 0.848
2022-08-04 02:49:46 - INFO - Epoch 3 step 500 lr 2.76782900871913e-05: total loss 0.518,accuracy1 0.850
2022-08-04 02:50:33 - INFO - Epoch 3 step 600 lr 2.6870874869438876e-05: total loss 0.515,accuracy1 0.852
2022-08-04 02:51:19 - INFO - Epoch 3 step 700 lr 2.606800739929779e-05: total loss 0.500,accuracy1 0.857
2022-08-04 02:52:06 - INFO - Epoch 3 step 800 lr 2.5270136831942915e-05: total loss 0.497,accuracy1 0.856
2022-08-04 02:52:52 - INFO - Epoch 3 step 900 lr 2.447770952708807e-05: total loss 0.497,accuracy1 0.856
2022-08-04 02:53:39 - INFO - Epoch 3 step 1000 lr 2.3691168799275106e-05: total loss 0.492,accuracy1 0.858
2022-08-04 02:54:25 - INFO - Epoch 3 step 1100 lr 2.2910954669866546e-05: total loss 0.489,accuracy1 0.859
2022-08-04 02:55:11 - INFO - Epoch 3 step 1200 lr 2.2137503620880613e-05: total loss 0.485,accuracy1 0.859
2022-08-04 02:55:58 - INFO - Epoch 3 step 1300 lr 2.1371248350806245e-05: total loss 0.485,accuracy1 0.860
2022-08-04 02:56:45 - INFO - Epoch 3 step 1400 lr 2.061261753253485e-05: total loss 0.484,accuracy1 0.860
2022-08-04 02:57:32 - INFO - Epoch 3 step 1500 lr 1.986203557354401e-05: total loss 0.484,accuracy1 0.860
2022-08-04 02:58:21 - INFO - Epoch 3 step 1600 lr 1.9119922378467528e-05: total loss 0.479,accuracy1 0.861
2022-08-04 02:59:13 - INFO - Epoch 3 step 1700 lr 1.8386693114184512e-05: total loss 0.477,accuracy1 0.862
2022-08-04 03:00:04 - INFO - Epoch 3 step 1800 lr 1.7662757977558917e-05: total loss 0.475,accuracy1 0.862
2022-08-04 03:00:58 - INFO - Epoch 3 step 1900 lr 1.6948521965959503e-05: total loss 0.474,accuracy1 0.862
2022-08-04 03:01:52 - INFO - Epoch 3 step 2000 lr 1.6244384650688666e-05: total loss 0.475,accuracy1 0.862
2022-08-04 03:02:49 - INFO - Epoch 3 step 2100 lr 1.5550739953446747e-05: total loss 0.474,accuracy1 0.861
2022-08-04 03:03:46 - INFO - Epoch 3 step 2200 lr 1.4867975925956915e-05: total loss 0.471,accuracy1 0.862
2022-08-04 03:04:44 - INFO - Epoch 3 step 2300 lr 1.4196474532874081e-05: total loss 0.469,accuracy1 0.863
2022-08-04 03:05:46 - INFO - Epoch 3 step 2400 lr 1.3536611438099034e-05: total loss 0.466,accuracy1 0.863
2022-08-04 03:06:47 - INFO - Epoch 3 step 2500 lr 1.2888755794617435e-05: total loss 0.465,accuracy1 0.864
2022-08-04 03:07:48 - INFO - Epoch 3 step 2600 lr 1.2253270037981475e-05: total loss 0.464,accuracy1 0.864
2022-08-04 03:08:54 - INFO - Epoch 3 step 2700 lr 1.1630509683549217e-05: total loss 0.461,accuracy1 0.865
2022-08-04 03:09:59 - INFO - Epoch 3 step 2800 lr 1.102082312759564e-05: total loss 0.461,accuracy1 0.865
2022-08-04 03:11:06 - INFO - Epoch 3 step 2900 lr 1.042455145240625e-05: total loss 0.461,accuracy1 0.865
2022-08-04 03:12:14 - INFO - Epoch 3 step 3000 lr 9.842028235462357e-06: total loss 0.461,accuracy1 0.865
2022-08-04 03:13:23 - INFO - Epoch 3 step 3100 lr 9.273579362825002e-06: total loss 0.460,accuracy1 0.866
